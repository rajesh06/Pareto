\documentclass[]{article} %scrartcl
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{parskip}
\usepackage{commath}
\usepackage{ifthen}
\usepackage[toc,page,header]{appendix}
\usepackage{arydshln}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{color}


%opening
\title{The Single Parameter Pareto Revisited}
\author{Rajesh Sahasrabuddhe, FCAS, MAAA}

\begin{document}

\maketitle

\begin{abstract}
In one of his seminal works, Stephen W. Philbrick proposed an elegant solution to the complex problem of modeling claims amounts in excess layers. 

\end{abstract}

\section{Introduction}
In one of his seminal works, Stephen W. Philbrick\cite{Philbrick} proposed an elegant solution to the complex problem of modeling claims amounts in excess layers. That solution involved the use a Pareto Type I distribution for claims above an excess threshold.\\

This paper expands on that work in several ways by providing the following:
\begin{enumerate}
	\item A consistent notational framework
	\item A review of the various formul\ae~including supporting derivation in the Appendices
	\item A discussion of parameter values less than or equal to 1
	\item A summary of the formul\ae to calcualte policy frequency and seveirty. This section also included  errata related to certain issues in Philbrick.
	\item An approach to allow consideration of maximum probable loss using order statistics
	\item Quantification of parameter uncertainty using Bayesian Markov chain Monte Carlo (MCMC) methods (expanding on the work of Meyers and Reichle \& Yonkunis)
	\item Frequency and severity trends
	\item Dealing with claims less than the threshold (expanding on the work of Fackler)
\end{enumerate}
\section{The \emph{Single Parameter} Pareto}
Philbrick's Single Parameter Pareto (SPP) is a special case of the Pareto Type I distribution which has the following cumulative distribution function:
\begin{equation}
F(x) = 1 - \left(\frac{k}{x} \right)^a\label{eqn:Pareto1}
\end{equation}
Many reviewers are often confused by the reference to the \emph{single parameter}. After all, \emph{Philbrick}, in Section III initially presents the Pareto with two parameters (Equation \ref{eqn:Pareto1}), $k$ and $a$, and then later adds that claims should be ``normalized'' by dividing by the ``selected lower bound''

This presentation leaves many readers not understanding how the lower bound,~$k$,  lost its parameter status. Philbrick explains that this is because:
\begin{quote}
	Although there may be situations where this value must	be estimated, in virtually all insurance applications this value will be selected in advance. (Section III)
\end{quote}
This explanation often leaves readers less than satisfied.

We offer the alternative that users of the SPP model should consider the process of normalizing the claims to be a transformation of the data rather than the application of a parameter. An analogous transformation occurs when we take $\log$s. When we do that, we do not consider the base of the logarithm to be a parameter. Similarly, we will not consider the lower bound to be a parameter.

To improve clarity of this concept, we present the following:

\begin{table}[h!]
	\centering
	\begin{tabular}[h]{ccc}
		\toprule
		\multirow{3}{*}{Random Variable}& Observed & Normalized\\
		& Claim & Claims\\
		& Amount & Amount \\ \midrule
		Symbol & $\mathbf{Y}$ & $\mathbf{X}$\\ \midrule
		\multirow{2}{*}{Transformation} & & $\mathbf{X}$  =  $g(\mathbf{Y})$\\
		& & $g(\mathbf{Y}) =   \mathbf{Y}/\text{lower bound}$  \\ \midrule
		Domain & [\text{lower bound}, $\infty$] & [1, $\infty$]\\ \midrule
		Density & $a \dfrac{k^a}{y^{a+1}}$ & $qx^{-(q+1)}$\\ \midrule
		Parameters & $k>0$ (scale); $a>0$ (shape)& $q>0$ (shape)\\ 
	\bottomrule
	\end{tabular}
	\caption{The Pareto Type I and the SPP}\label{tbl:PIvSpp}			
\end{table}
We can now work with model forms in the space of $\mathbf{X}$ and then use $g^{-1}$ to transform back into the space of $\mathbf{Y}$. We can also now present the density and distribution functions.

\begin{align}
		f(x) & =  qx^{-(q+1)}\label{SPPf}\\
		F(x) & =  1 - x^{-q}\label{SPPF}
\end{align}

In  Appendix \ref{ParetoF}, we provide the derivation of the distribution function (Equation (\ref{SPPF})).

\subsection{Other Pareto Forms}
In Appendix \ref{ParetoInventory}, we provide an inventory of Pareto distributions including the SPP presented in Equations (\ref{SPPf}) and (\ref{SPPF}). 

\section{Actuarial Formul\ae}
In general, we leave formula derivation to the Appendices of this paper. In Appendix \ref{derive:ParetoEV}, we present the derivation of the expected value:

\begin{equation}
\mathbb{E}[X]  = 
\begin{cases}
\dfrac{q}{q-1},& \text{if } q > 1\\
\text{undefined},& \text{if } q \leq 1\\         
\end{cases}
\end{equation}

%For the remainder of Section \ref{Prelims}, we will restrict ourselves to the $q>1$ case. 

We can use Equation (\ref{EV}), to calculate the limited expected value through $b$
as presented in Appendix \ref{ParetoLEV} as:\footnote{Philbrick used $b$ to refer to both the ``lower bound" and the policy limit. We will not do that in this paper primarily for clarity as using a variable to represent the lower bound implied at least the possibility that the lower bound was a parameter. Conveniently, it also allows us  to use the traditional policy notation as attaching at $AP$ through limit $L$ with the resulting layer width equal to $L - L$.} 
\begin{equation}
	\mathbb{E}[X;b] = \frac{q - b^{1-q}}{q-1}\label{eqntx:ParetoLEV}
\end{equation}

In that derivation, there is no restriction that $q > 1$. That is, we recognize that, although the limited expected value is undefined, expected values are defined when we have an upper limit (such as a policy limit). As such, users of the SPP need not ``fear'' $q$ values less than 1 for most insurance applications.

So for the expected claim amount for the layer between $AP$ and $L$, we have:

\begin{align}
\mathbb{E}[X;AP, L] &= \frac{q - L^{1-q}}{q-1} - \frac{q - AP^{1-q}}{q-1}\nonumber \\
&= \frac{AP^{1-q} - L^{1-q}}{q-1}\label{eqn:layerclaims}
\end{align}

This is, of course, likely the most common use of the SPP, estimating claims for an excess policy. This was also a focus of Section III of Philbrick's paper. I belive that that section includes one minor typographical error and a second calculation error. These are discussed below.
\subsection{Errata}
\subsubsection{Philbrick Errata \#1}
	In the application of formula \ref{eqntx:ParetoLEV}, we should understand that there is a minor typographical error in Philbrick\cite{Philbrick}. The second paragraph following Equation (6) appears on Page 56 and includes the following:
	\begin{quote}
		\begin{align}
		b &= 20 \color{red}\times\color{black} (500,000/25,000)\nonumber\\
		&\text{which should be}\nonumber\\
		b &= 20 \color{red} = \color{black} 500,000/25,000\nonumber
		\end{align}
	\end{quote}

\subsubsection{Philbrick Errata \#2}
Starting at the bottom on Page 58 and extending to Page 59, Philbrick presents an example with a $q$ parameter of $1.5$ and expected claim count of 7 that results in the following (where $S(x)$ represents the survival function):

\begin{align}
F(4) &= 1 - 4^{-1.5}\nonumber\\
F(4) &= 7/8\nonumber\\
S(4) &= 1 - F(4) = 1/8\nonumber
\end{align}
\begin{align}
\mathbb{E}[n] &= 7\nonumber\\
\mathbb{E}[n; x > 4] &= 7 \times S(4) = 7/8\label{eqn:exfreq}
\end{align}

(It is unfortunate that, in this example both $\mathbb{E}[n; x > 4]$ and $S(4)$ both equal $7/8$. )

\begin{align}
\mathbb{E}[X] &= \frac{1.5}{1.5-1}\nonumber\\
\mathbb{E}[X] &= 3\nonumber
\end{align}

\begin{align}
\mathbb{E}[X; 4] &= \dfrac{1.5 - 4^{1-1.5}}{1.5-1}\nonumber\\
\mathbb{E}[X; 4] &= \dfrac{1.5 - 4^{-0.5}}{0.5}\nonumber\\
\mathbb{E}[X; 4] &= \dfrac{1.5 - .5}{0.5}\nonumber\\
\mathbb{E}[X; 4] &= 2\nonumber
\end{align}
The average severity of claims in the layer is $(\mathbb{E}[X] - \mathbb{E}[X; 4]) / S(4) = 8$. Using the frequency calculated in Equation (\ref{eqn:exfreq}), we estimate claims in the layer to be $8 \times 7 / 8 = 7$ which agrees with Philbrick's calculation.

The error occurs when the example is extended to calculate claims in the layer from $AP = 3$ to $L = 7.5$. Using the approach above and the following:
\begin{align}
\mathbb{E}[X;3] &= 1.845299\nonumber\\
\mathbb{E}[X;7.5] &= 2.269703\nonumber\\
F(3) &= 0.8075499\nonumber\\
S(3) &= 0.1924501\nonumber.
\end{align}
With that we have average claim amounts in the layer at 
\begin{equation}
\frac{\mathbb{E}[X;7.5] - \mathbb{E}[X;3]}{1 - F(3)} = 2.205267 \nonumber
\end{equation}
which agrees with Philbrick's calculation of ``net average claim size'' on Page 59. However, the corresponding frequency should be $ 7 \times S(3)$ = 1.347151 and a resulting expected claims in the layer of 2.970827. The purpose of the $F(87,500/75,000) = F(2.5)$ term in the frequency calculation is not entirely clear to this author. 

\subsection{Policy Claims Estimate}
The purpose of the Philbrick calculation was likely demonstrate that the average claim size in the layer between $AP$ and $L$ was equal to the expected value of claims limited to $L / AP$ net of the lower bound but multiplied by $AP$. The latter is calculated as Equation (\ref{eqntx:ParetoLEV}) $- 1$ which simplifies to:
\begin{equation}
\frac{1 - b^{1-q}}{q-1} \times AP
\end{equation}


We can demonstrate that as follows using Equation (\ref{eqn:layerclaims}) and the survival function as follows:
\begin{align}
\dfrac{\dfrac{AP^{1-q} - L^{1-q}}{q-1}}{S(AP)} &= 
\dfrac{\dfrac{AP^{1-q} - L^{1-q}}{q-1}}{AP^{-q}}\nonumber\\
&= \frac{1}{q-1} \times \frac{AP}{AP} \times \frac{AP^{1-q} - L^{1-q}}{AP^{-q}}\nonumber\\
&= \frac{AP}{q-1} \times \frac{AP^{1-q} - L^{1-q}}{AP^{1-q}}\nonumber\\
&= \frac{AP}{q-1} \times \left(1 - \left(\frac{L}{AP}\right)^{1-q}\right)\nonumber\\
&= \frac{1 - (L/AP)^{1-q}}{q-1} \times AP
\end{align}

As mentioned, the most common actuarial application of the SPP is to estimate the number of claims, their average value and the resulting aggregate claim amount to a policy. We therefore summarize those formul\ae~in the Table \ref{tbl:PolicyFormulas}.
\begin{table}[h!]
	\centering
	\begin{tabular}[h]{cc}
		\toprule
		Number of Claims & $S(AP) = AP^{-q}$\\ \midrule
		Average Value of Individual Claims & $\dfrac{1 - (L/AP)^{1-q}}{q-1} \times AP$\\ \midrule
		Aggregate Claim Amount & $\dfrac{AP^{1-q} - L^{1-q}}{q-1}$\\
		\bottomrule
	\end{tabular}
	\caption{Policy Analysis}\label{tbl:PolicyFormulas}			
\end{table}
 
\section{The Parameter}
\section{Trend}

\newpage
\appendix
\appendixpage
% How to insert here a TOC concerning only the appendix sections ????

\section{An Inventory of Pareto Distributions}\label{ParetoInventory}
Appendix first content.
\section{Derivation of Forumul\ae}
\subsection{SPP Cumulative Distribution Function}\label{ParetoF}
\begin{align}
	F(x) &= \int_{1}^{x} f(x) \dif x \nonumber\\
		&= \int_{1}^{x}qx^{-(q+1)} \dif x\nonumber\\
		&= q \int_{1}^{x}x^{-(q+1)} \dif x\nonumber\\
		&= q \frac{1}{-(q+1)+1} x^{-q} \Big|_{1}^{x}\nonumber\\
		&=  q \frac{1}{-q} x^{-q} \Big|_{1}^{x}\nonumber\\
		&=  - x^{-q}\Big|_{1}^{x}\nonumber\\
		&= -x^{-q} - (-1^{-q})\nonumber\\
	 F(x) &=  1 - x^{-q}
\end{align}
\subsection{SPP Expected Value}\label{derive:ParetoEV}
We can derive the expected values as:
\begin{align}
\mathbb{E}[X] & = \int_{1}^{\infty}x f(x) \dif x \nonumber\\
& = \int_{1}^{\infty}xqx^{-(q+1)} \dif x\nonumber\\
& = q \int_{1}^{\infty}x^{-q} \dif x\nonumber\\
& = q \frac{1}{-q+1} x^{-q+1} \Big|_{1}^{\infty}\nonumber\\
& = \frac{q}{1-q} x^{-q+1} \Big|_{1}^{\infty}\nonumber\\
\mathbb{E}[X] 	& = \frac{q}{1-q} \dfrac{1}{x^{q-1}} \Big|_{1}^{\infty}\label{EV}
\end{align}
We can see that for $x = 1$ (the lower limit of integration) equation (\ref{EV}) evaluates to $\dfrac{q}{1-q}$. However for $x = \infty$, we have the following\footnote{In the limit as $x\to\infty$, the expression evaluates to  $-\dfrac{q}{q+1}$. However evaluated at $\infty$, the expression is undefined.}:

\[
\frac{q}{1-q} \dfrac{1}{x^{q-1}} = 
\begin{cases}
0,& \text{if } q > 1\\
\text{undefined},& \text{if } q = 1\\         
\infty, & \text{if }q < 1
\end{cases}
\]

and therefore we have: 
\[
\mathbb{E}[X]  = 
\begin{cases}
0 - \dfrac{q}{1-q},& \text{if } q > 1\\
\text{undefined},& \text{if } q = 1\\         
\infty, & \text{if }q < 1
\end{cases}
\]
or more simply:

\begin{equation}
\mathbb{E}[X]  = 
\begin{cases}
\dfrac{q}{q-1},& \text{if } q > 1\\
\text{undefined},& \text{if } q \leq 1\\         
\end{cases}
\end{equation}

\subsection{SPP Limited Expected Value}\label{ParetoLEV}
The limited expected value is calculated as:
\begin{align}
	\mathbb{E}[X;b] 	&= \frac{q}{1-q} \dfrac{1}{x^{q-1}} \Big|_{1}^{b} + b  (1-F(b))\nonumber\\
 	&=  \frac{q}{1-q} \left[ \dfrac{1}{b^{q-1}} - \dfrac{1}{1^{q-1}}\right]+  b  \left[1-(1-b^{-q})\right]\nonumber\\
 	&=  \frac{q}{1-q} \left[ \dfrac{1}{b^{q-1}} - 1\right]+  b  \left[b^{-q}\right]\nonumber\\
 	&=  \frac{q}{q-1} \left[1 - \dfrac{1}{b^{q-1}}\right]+ b^{1-q}\nonumber\\
 	&=  \frac{q}{q-1} \left[1 - b^{1-q}\right]+b^{1-q}\\ %This is the formula with E[X] 
 	&=  \frac{1}{q-1} \left[q - qb^{1-q} + (q-1)b^{1-q}\right]\nonumber\\
 	&=  \frac{1}{q-1} \left[q - b^{1-q}\right]\nonumber\\
 	&=	\frac{q - b^{1-q}}{q-1}
 \end{align}
 
\bibliographystyle{plain}
\bibliography{MyBib}
\end{document}
